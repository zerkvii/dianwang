<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <!-- Tell the browser to be responsive to screen width -->
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    <!-- Favicon icon -->
    <link rel="icon" type="image/png" sizes="16x16" href="/static/assets/images/state_grid.png">

    <title>{{ title }}</title>
    <!-- Bootstrap Core CSS -->
    <link href="/static/assets/plugins/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <!-- chartist CSS -->
    <link href="/static/css/googlefonts.css">
    <link href="/static/assets/plugins/chartist-js/dist/chartist.min.css" rel="stylesheet">
    <link href="/static/assets/plugins/chartist-js/dist/chartist-init.css" rel="stylesheet">
    <link href="/static/assets/plugins/chartist-plugin-tooltip-master/dist/chartist-plugin-tooltip.css" rel="stylesheet">
    <!--This page css - Morris CSS -->
    <link href="/static/assets/plugins/c3-master/c3.min.css" rel="stylesheet">
    <!-- Custom CSS -->
    <link href="/static/css/style.css" rel="stylesheet">
    <!-- You can change the theme colors from here -->
    <link href="/static/css/colors/zcolor.css" id="theme" rel="stylesheet">
    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->
</head>

<body class="fix-header fix-sidebar card-no-border logo-center">

<!-- alert flash -->
<div class="modal fade" id="overlay">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-body">
                <p id="zcontent">内容</p>
            </div>
        </div>
    </div>
</div>
<!-- ============================================================== -->
<!-- Preloader - style you can find in spinners.css -->
<!-- ============================================================== -->
<div class="preloader">
    <svg class="circular" viewBox="25 25 50 50">
        <circle class="path" cx="50" cy="50" r="20" fill="none" stroke-width="2" stroke-miterlimit="10"/>
    </svg>
</div>
<!-- ============================================================== -->
<!-- Main wrapper - style you can find in pages.scss -->
<!-- ============================================================== -->
<div id="main-wrapper">
    <!-- ============================================================== -->
    <!-- Topbar header - style you can find in pages.scss -->
    <!-- ============================================================== -->

    <header class="topbar">
        <nav class="navbar top-navbar navbar-expand-md navbar-light">
            <!-- ============================================================== -->
            <!-- Logo -->
            <!-- ============================================================== -->
            <div class="navbar-header">
                <a class="navbar-brand" href="index.html">
                    <!-- Logo icon --><b>
                    <!-- Dark Logo icon -->
                    <img src="/static/assets/images/state_grid.png" alt="homepage" class="light-logo" style="width: 50px"/>
                    <!-- Light Logo icon -->
                </b>
                    <!--End Logo icon -->
                    <!-- Logo text --><span>
                                    <b></b>
                    <!-- dark Logo text -->
                    <!-- Light Logo text -->
                         <img src="/static/assets/images/logo.png" class="light-logo img-responsive" alt="homepage"
                              style="width: 80%"/></span> </a>
            </div>
            <!-- ============================================================== -->
            <!-- End Logo -->
            <!-- ============================================================== -->
            <div class="navbar-collapse">
                <!-- ============================================================== -->
                <!-- toggle and nav items -->
                <!-- ============================================================== -->
                <ul class="navbar-nav mr-auto mt-md-0">
                    <!-- This is  -->
                    <li class="nav-item"><a class="nav-link nav-toggler hidden-md-up text-muted waves-effect waves-dark"
                                            href="javascript:void(0)"><i class="mdi mdi-menu"></i></a></li>
                    <!-- ============================================================== -->
                    <!-- Search -->
                    <!-- ============================================================== -->
                    <li class="nav-item hidden-sm-down search-box"><a
                            class="nav-link hidden-sm-down text-muted waves-effect waves-dark"
                            href="javascript:void(0)"><i class="ti-search"></i></a>
                        <form class="app-search">
                            <input type="text" class="form-control" placeholder="快速搜索"> <a class="srh-btn"><i
                                class="ti-close"></i></a></form>
                    </li>
                    <!-- ============================================================== -->
                </ul>
                <!-- ============================================================== -->
                <!-- User profile and search -->
                <!-- ============================================================== -->
                <ul class="navbar-nav my-lg-0">
                    <!-- ============================================================== -->
                    <!-- Comment -->
                    <!-- ============================================================== -->
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle text-muted text-muted waves-effect waves-dark" href=""
                           data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"> <i
                                class="mdi mdi-message"></i>
                            <div class="notify"><span class="heartbit"></span> <span class="point"></span></div>
                        </a>
                        <div class="dropdown-menu dropdown-menu-right mailbox scale-up">
                            <ul>
                                <li>
                                    <div class="drop-title">通知</div>
                                </li>
                                <li>
                                    <div class="message-center">
                                        <!-- Message -->
                                        <a href="#">
                                            <div class="btn btn-danger btn-circle"><i class="fa fa-link"></i></div>
                                            <div class="mail-contnet">
                                                <h6>通知样例</h6> <span class="mail-desc">新的备案申请</span> <span class="time">2019-1-13 12:30</span>
                                            </div>
                                        </a>
                                    </div>
                                </li>
                                <li>
                                    <a class="nav-link text-center" href="javascript:void(0);"> <strong>标记所有为已读</strong>
                                        <i class="fa fa-angle-right"></i> </a>
                                </li>
                            </ul>
                        </div>
                    </li>
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle text-muted waves-effect waves-dark" href=""
                           data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><img
                                src="/static/assets/images/state_grid.png" alt="user" class="profile-pic"/></a>
                        <div class="dropdown-menu dropdown-menu-right scale-up">
                            <ul class="dropdown-user">
                                <li>
                                    <div class="dw-user-box">
                                        <div class="u-img"><img src="/static/assets/images/state_grid.png" alt="user"></div>
                                        <div class="u-text">
                                            <h4>{{ current_user.username }}</h4>
                                            <p class="text-muted">{{ current_user.email }}</p><a href="profile.html"
                                                                                                 class="btn btn-rounded btn-danger btn-sm"
                                                                                                 style="color: white;">查看个人信息</a>
                                        </div>
                                    </div>
                                </li>
                                <li role="separator" class="divider"></li>
                                <li><a href="#"><i class="ti-layers"></i>&nbsp&nbsp已处理的备案</a></li>
                                <li><a href="#"><i class="ti-layers-alt"></i>&nbsp&nbsp未处理的备案</a></li>
                                <li role="separator" class="divider"></li>
                                <li><a href="/logout"><i class="fa fa-power-off"></i>&nbsp&nbsp退出</a></li>
                            </ul>
                        </div>
                    </li>
                    <!-- ============================================================== -->

                </ul>
            </div>
        </nav>
    </header>    <!-- ============================================================== -->
    <!-- End Topbar header -->
    <!-- ============================================================== -->
    <!-- ============================================================== -->
    <!-- Left Sidebar - style you can find in sidebar.scss  -->
    <!-- ============================================================== -->
    <aside class="left-sidebar" style="background: white">
        <!-- Sidebar scroll-->
        <div class="scroll-sidebar">
            <!-- Sidebar navigation-->
            <nav class="sidebar-nav">
                <ul id="sidebarnav">
                    <li class="nav-small-cap"></li>
                    <li>
                        <a class="has-arrow" href="/backend" aria-expanded="false"><i class="mdi mdi-gauge"></i><span
                                class="hide-menu">系统状态</span></a>
                    </li>
                    <li>
                        <a class="has-arrow " href="/backend/overview" aria-expanded="false"><i
                                class="mdi mdi-chart-bar"></i><span
                                class="hide-menu">备案概览</span></a>
                    </li>
                    <li>
                        <a class="has-arrow" href="/backend/lookup" aria-expanded="false"><i
                                class="mdi mdi-airplay"></i><span
                                class="hide-menu">查看备案</span></a>
                    </li>
                    <li>
                        <a class="has-arrow" href="/backend/approval" aria-expanded="false"><i
                                class="mdi mdi-pencil"></i><span
                                class="hide-menu">审批备案</span></a>
                    </li>
                    <li>
                        <a class="has-arrow" href="/backend/help" aria-expanded="false"><i
                                class="mdi mdi-chart-bubble"></i><span
                                class="hide-menu">帮助</span></a>
                    </li>
                </ul>
            </nav>
            <!-- End Sidebar navigation -->
        </div>
        <!-- End Sidebar scroll-->
    </aside>============= -->
    <!-- End Left Sidebar - style you can find in sidebar.scss  -->
    <!-- ============================================================== -->
    <!-- ============================================================== -->
    <!-- Page wrapper  -->
    <!-- ============================================================== -->
    <div class="page-wrapper">
        <!-- ============================================================== -->
        <!-- Container fluid  -->
        <!-- ============================================================== -->
        <div class="container-fluid">
            <!-- ============================================================== -->
            <!-- Bread crumb and right sidebar toggle -->
            <!-- ============================================================== -->
            <div class="row page-titles">
                <div class="col-md-5 col-8 align-self-center">
                    <h4 class="text-themecolor">{{ title }}</h4>
                    <ol class="breadcrumb">
                        <li class="breadcrumb-item"><a href="javascript:void(0)">主页</a></li>
                        <li class="breadcrumb-item active">{{ title }}</li>
                    </ol>
                </div>
                <div class="col-md-7 col-4 align-self-center">
                    <div class="d-flex m-t-10 justify-content-end">
                        <div class="d-flex m-r-20 m-l-10 hidden-md-down">
                            <div class="chart-text m-r-10">
                                <h6 class="m-b-0">
                                    <small>本月</small>
                                </h6>
                                <h4 class="m-t-0 text-info">55</h4></div>
                            <div class="spark-chart">
                                <div id="monthchart"></div>
                            </div>
                        </div>
                        <div class="d-flex m-r-20 m-l-10 hidden-md-down">
                            <div class="chart-text m-r-10">
                                <h6 class="m-b-0">
                                    <small>上月</small>
                                </h6>
                                <h4 class="m-t-0 text-primary">66</h4></div>
                            <div class="spark-chart">
                                <div id="lastmonthchart"></div>
                            </div>
                        </div>
                        <div class="">
                            <button class="right-side-toggle waves-effect waves-light btn-success btn btn-circle btn-sm pull-right m-l-10">
                                <i class="ti-settings text-white"></i></button>
                        </div>
                    </div>
                </div>
            </div>
            <!-- ============================================================== -->
            <!-- End Bread crumb and right sidebar toggle -->
            <!-- ============================================================== -->
            <!-- ============================================================== -->
            <!-- Start Page Content -->
            <!-- ============================================================== -->
            <!-- Row -->
            <div class="row">
                <!-- Column -->
                <div class="col-lg-12">
                    <div class="card">
                        <div class="card-body">
                            <h4 class="card-title">历史数据统计</h4>
                            <div class="flot-chart">
                                <div class="sales-bars-chart" style="height: 320px;"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Row -->
{#            <div class="row">#}
{#                <!-- column -->#}
{#                <div class="col-lg-6">#}
{#                    <div class="card">#}
{#                        <div class="card-body">#}
{#                            <h4 class="card-title">系统容量</h4>#}
{#                            <div class="flot-chart">#}
{#                                <div class="flot-chart-content" id="flot-pie-chart"></div>#}
{#                            </div>#}
{#                        </div>#}
{#                    </div>#}
{#                </div>#}
{#                <!-- column -->#}
{#            </div>#}
            <!-- Row -->

            <!-- ============================================================== -->
            <!-- End PAge Content -->
            <!-- ============================================================== -->
            <!-- ============================================================== -->
            <!-- Right sidebar -->
            <!-- ============================================================== -->
            <!-- .right-sidebar -->
            <div class="right-sidebar">
                <div class="slimscrollright">
                    <div class="rpanel-title"> 主题设置 <span><i class="ti-close right-side-toggle"></i></span>
                    </div>
                    <div class="r-panel-body">
                        <ul id="themecolors" class="m-t-20">
                            <li><b>亮色主题</b></li>
                            <li><a href="javascript:void(0)" data-theme="default" class="default-theme">1</a></li>
                            <li><a href="javascript:void(0)" data-theme="green" class="green-theme">2</a></li>
                            <li><a href="javascript:void(0)" data-theme="red" class="red-theme">3</a></li>
                            <li><a href="javascript:void(0)" data-theme="blue" class="blue-theme working">4</a></li>
                            <li><a href="javascript:void(0)" data-theme="purple" class="purple-theme">5</a></li>
                            <li><a href="javascript:void(0)" data-theme="megna" class="megna-theme">6</a></li>
                            <li class="d-block m-t-30"><b>暗色主题</b></li>
                            <li><a href="javascript:void(0)" data-theme="default-dark" class="default-dark-theme">7</a>
                            </li>
                            <li><a href="javascript:void(0)" data-theme="green-dark" class="green-dark-theme">8</a></li>
                            <li><a href="javascript:void(0)" data-theme="red-dark" class="red-dark-theme">9</a></li>
                            <li><a href="javascript:void(0)" data-theme="blue-dark" class="blue-dark-theme">10</a></li>
                            <li><a href="javascript:void(0)" data-theme="purple-dark" class="purple-dark-theme">11</a>
                            </li>
                            <li><a href="javascript:void(0)" data-theme="megna-dark" class="megna-dark-theme ">12</a>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
            <!-- ============================================================== -->
            <!-- End Right sidebar -->
            <!-- ============================================================== -->
        </div>
        <!-- ============================================================== -->
        <!-- End Container fluid  -->
        <!-- ============================================================== -->
        <!-- ============================================================== -->
        <!-- footer -->
        <!-- ============================================================== -->
        <footer class="footer text-dark"> © 武汉大学国家网络安全学院 2018-2028</footer>
        <!-- ============================================================== -->
        <!-- End footer -->
        <!-- ============================================================== -->
    </div>
    <!-- ============================================================== -->
    <!-- End Page wrapper  -->
    <!-- ============================================================== -->
</div>
<!-- ============================================================== -->
<!-- End Wrapper -->
<!-- ============================================================== -->
<!-- ============================================================== -->
<!-- All Jquery -->
<!-- ============================================================== -->
<script src="/static/assets/plugins/jquery/jquery.min.js"></script>
<!-- Bootstrap tether Core JavaScript -->
<script src="/static/assets/plugins/bootstrap/js/popper.min.js"></script>
<script src="/static/assets/plugins/bootstrap/js/bootstrap.min.js"></script>
<!-- slimscrollbar scrollbar JavaScript -->
<script src="/static/js/jquery.slimscroll.js"></script>
<!--Wave Effects -->
<script src="/static/js/waves.js"></script>
<!--Menu sidebar -->
<script src="/static/js/sidebarmenu.js"></script>
<!--stickey kit -->
<script src="/static/assets/plugins/sticky-kit-master/dist/sticky-kit.min.js"></script>
<script src="/static/assets/plugins/sparkline/jquery.sparkline.min.js"></script>
<script src="/static/assets/plugins/sparkline/jquery.sparkline.min.js"></script>
<!--Custom JavaScript -->
<script src="/static/js/custom.min.js"></script>
<!-- ============================================================== -->
<!-- This page plugins -->
<script src="/static/assets/plugins/flot/excanvas.js"></script>
<script src="/static/assets/plugins/flot/jquery.flot.js"></script>
<script src="/static/assets/plugins/flot/jquery.flot.pie.js"></script>
<script src="/static/assets/plugins/flot/jquery.flot.time.js"></script>
<script src="/static/assets/plugins/flot/jquery.flot.stack.js"></script>
<script src="/static/assets/plugins/flot/jquery.flot.crosshair.js"></script>
<script src="/static/assets/plugins/flot.tooltip/js/jquery.flot.tooltip.min.js"></script>
<script src="/static/js/flot-data.js"></script>
<!-- ============================================================== -->
<!-- chartist chart -->
<script src="/static/assets/plugins/chartist-js/dist/chartist.min.js"></script>
<script src="/static/assets/plugins/chartist-plugin-tooltip-master/dist/chartist-plugin-tooltip.min.js"></script>
<!--c3 JavaScript -->
<script src="/static/assets/plugins/d3/d3.min.js"></script>
<script src="/static/assets/plugins/c3-master/c3.min.js"></script>
<!-- Chart JS -->
{#<script src="js/dashboard1.js"></script>#}
<!-- ============================================================== -->

<!-- ============================================================== -->
<!-- Style switcher -->
<!-- ============================================================== -->
<!-- Style switcher -->

<!-- ============================================================== -->
<script src="/static/assets/plugins/styleswitcher/jQuery.style.switcher.js"></script>
{#<script src="/static/js/socketio.js"></script>#}
{#<script type="text/javascript" charset="utf-8">#}
{#    $(document).ready(function () {#}
{#        const namespace = '/backend'; // change to an empty string to use the global namespace#}
{#        // the socket.io documentation recommends sending an explicit package upon connection#}
{#        // this is specially important when using the global namespace#}
{#        let socket = io.connect('http://' + document.domain + ':' + location.port + namespace);#}
{##}
{#        // socket.on('connect', function(msg) {#}
{#        //   socket.emit('my event', {data: 'I\'m connected!'});#}
{#        //});#}
{##}
{#        socket.on('event', function (msg) {#}
{#            alert(msg)#}
{#        });#}
{##}
{#    });#}
{#</script>#}
{% with messages = get_flashed_messages() %}
    {% if messages %}
        <script>
            let messages ={{ messages | safe }};
            for (let i = 0; i < messages.length; i++) {
                $('#overlay').modal('show');
                $('#zcontent').text(messages[i]);
                setTimeout(function () {
                    $('#overlay').modal('hide');
                }, 1200);
            }
        </script>
    {% endif %}
{% endwith %}
// flot moving chart
<script>
    var data = []
        , totalPoints = 300;

    function getRandomData() {
        if (data.length > 0) data = data.slice(1);
        // Do a random walk
        while (data.length < totalPoints) {
            var prev = data.length > 0 ? data[data.length - 1] : 50
                , y = prev + Math.random() * 10 - 5;
            if (y < 0) {
                y = 0;
            } else if (y > 100) {
                y = 100;
            }
            data.push(y);
        }
        // Zip the generated y values with the x values
        var res = [];
        for (var i = 0; i < data.length; ++i) {
            res.push([i, data[i]])
        }
        return res;
    }

    // Set up the control widget
    var updateInterval = 30;
    $("#updateInterval").val(updateInterval).change(function () {
        var v = $(this).val();
        if (v && !isNaN(+v)) {
            updateInterval = +v;
            if (updateInterval < 1) {
                updateInterval = 1;
            } else if (updateInterval > 3000) {
                updateInterval = 3000;
            }
            $(this).val("" + updateInterval);
        }
    });
    var plot = $.plot("#placeholder", [getRandomData()], {
        series: {
            shadowSize: 0 // Drawing is faster without shadows
        }
        , yaxis: {
            min: 0
            , max: 100
        }
        , xaxis: {
            show: false
        }
        , colors: ["#26c6da"]
        , grid: {
            color: "#AFAFAF"
            , hoverable: true
            , borderWidth: 0
            , backgroundColor: '#FFF'
        }
        , tooltip: true
        , tooltipOpts: {
            content: "Y: %y"
            , defaultTheme: false
        }
    });

    function update() {
        plot.setData([getRandomData()]);
        // Since the axes don't change, we don't need to call plot.setupGrid()
        plot.draw();
        setTimeout(update, updateInterval);
    }

    update();
</script>

<script>
    $('document').ready(function () {
        getRealData(0);
        setInterval(function () {
            getRealData(1)
        }, 10000);//request every x seconds

    });

    function getRealData(first) {
        $.ajax({
            url: "/apis/notice",
            type: "POST",
            data: {
                type: 0,
                first: first
            },
            cache: false,
            success: function (data) {

                appendNotice(data['urls'], data['date']);
            }
        })
    }

    function appendNotice(data, date) {
        for (x in data) {
            let liNode = $.parseHTML('<a href=' + data[x] + '><div class="btn btn-danger btn-circle"><i class="fa fa-link"></i></div><div class="mail-contnet"><h6>通知</h6><span class="mail-desc">新的备案申请</span><span class="time">' + date[x] + '</span></div></a>')
            {#console.log(liNode)#}
            $("#notices").append(liNode)
        }
    }

</script>
</body>
</html>
