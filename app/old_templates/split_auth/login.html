<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>{{ title }}</title>
    <link rel="stylesheet" href="/static/split_css/bootstrap.min.css">
    <link rel="stylesheet" href="/static/split_css/split_login.css">
</head>
<body>
<div class="tile">
    <div class="tile-header">
        <h2 style="color: darkcyan; opacity: .75; font-size: 4rem; display: flex; justify-content: center; align-items: center; height: 100%;">
            登录</h2>
    </div>
    {#<div class="logo-image">#}
    {#    <img src="/static/split_assets/sg.png" alt="Logo" title="Logo">#}
    {#</div>#}
    <div class="title-body">
        <div class="modal-content">

            {#        <p class="subhead">登录</p>#}
            <form id="loginform" class="modal-body">
                <label class="form-input">
                    <i class="fa fa-user"></i>
                    <input type="text" id="username" autofocus="true" required/>
                    <span class="label">用户名/邮箱</span>
                    <span class="underline"></span>
                </label>
                <label class="form-input">
                    <i class="fa fa-lock"></i>
                    <input type="password" id="password" required/>
                    <span class="label">密码</span>
                    <span class="underline"></span>
                </label>
                {#            <div id="form-login-username" class="form-group">#}
                {#                <input id="username" class="form-control" name="username" type="text" size="18" alt="login"/>#}
                {#                <label for="username" class="float-label">用户名</label>#}
                {#            </div>#}
                {#            <div id="form-login-password" class="form-group">#}
                {#                <input id="password" class="form-control" name="password" type="password" size="18" alt="password"#}
                {#                       required>#}
                {#                <label for="password" class="float-label">密码</label>#}
                {#            </div>#}
                <div id="form-login-remember" class="form-group">
                    <div class="checkbox checkbox-default">
                        <input id="remember" type="checkbox" value="yes" alt="Remember me" class="">
                        <label for="remember">记住我</label>
                    </div>
                </div>
                <div>
                    <button class="btn btn-block btn-info" id="btn_login">登录
                    </button>
                    <button class="btn btn-block btn-info" id="register_btn">注册</button>
                </div>
            </form>
        </div>
    </div>

    <script type="text/javascript" src="/static/split_js/bootstrap.min.js"></script>
    <script type="text/javascript" src="/static/split_js/jquery.min.js"></script>
    <script type="text/javascript" src="/static/split_js/swal.js"></script>
    <script>
        function getFormData($form) {
            let unindexed_array = $form.serializeArray();
            let indexed_array = {};
            $.map(unindexed_array, function (n) {
                indexed_array[n['name']] = n['value'];
            });
            return indexed_array;
        }

        $(function () {
            $("#btn_login").click(
                function (e) {
                    e.preventDefault();
                    $.ajax({
                        type: 'POST',
                        contentType: "application/json",
                        dataType: 'json',
                        url: window.location.search,
                        data: JSON.stringify(getFormData($('#loginform'))),
                        success: function (data) {
                            window.location.href = data['next_page'];
                        },
                        error: function (xhr) {
                            let information = $.parseJSON(xhr.responseText);
                            swal({
                                title: "错误",
                                text: information['information'],
                                icon: "error",
                                button: "确定"
                            },)
                        }
                    })
                }
            );
            $("#register_btn").click(function (e) {
                e.preventDefault();
                window.location.href = "/register";

            })
        })
    </script>

</body>
</html>